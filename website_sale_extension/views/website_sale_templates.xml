<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="assets_frontend" inherit_id="website_sale.assets_frontend" name="Website Sale Extension Assets">
        <xpath expr="." position="inside">
            <link rel="stylesheet" href="/website_sale_extension/static/src/css/website_sale_extension.css" />

            <script type="text/javascript" src="/website_sale_extension/static/src/js/website_sale_extension.js"></script>
        </xpath>
    </template>


    <!-- /shop/product | Product Page -->
    <template id="product_inherit_wwebsite_sale_extension" inherit_id="website_sale.product">
        <xpath expr="//div[@id='product_details']//div[hasclass('js_product')]/t[1]" position="after">
            <div class="o_wse_bom_selector">
                <!-- BOM selector is append here -->
            </div>
        </xpath>
    </template>


    <!-- Product BOM selector -->
    <template id="product_bom_selector_recursive">
        <details t-foreach="rec_bom_lines" t-as="bom_line" t-att="{'hidden': bom_line.is_hidden_component}">
            <summary t-att-class="(bom_line.is_default_bom or bom_line.is_hidden_component) and 'o_wse_bom_selected' or ''" t-att-data-price="bom_line.lst_price" t-att-data-name="bom_line.product_id.name" t-att-selectable="bom_line.is_child_line" t-att-hidden="bom_line.is_hidden_component" t-att-data-id="bom_line.id" >
                <span t-esc="bom_line.product_id.name" />
                <div class="selector"></div>
            </summary>
            <t t-set="temp_bom_lines" t-value="rec_bom_lines" />
            <t t-set="rec_bom_lines" t-value="bom_line.product_id.bom_ids.bom_line_ids" />
            <t t-call="website_sale_extension.product_bom_selector_recursive" />
            <t t-set="rec_bom_lines" t-value="temp_bom_lines" />
        </details>
    </template>

    <template id="product_bom_selector" name="product.bom.selector">
        <div class="o_wse_bom_selector_cart" t-att-data-unit_price="product.lst_price"></div>
        <input type="hidden" name="bom_line_ids" class="o_wse_bom_line_ids" value="" />
        <t t-if="bom_lines">
            <t t-set='rec_bom_lines' t-value="bom_lines" />
            <t t-call="website_sale_extension.product_bom_selector_recursive" />
        </t>
    </template>

</odoo>
